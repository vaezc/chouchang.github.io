title: 子网掩码详解(转)
date: 2016-01-13 13:47:09
categories:
- 网络
tags:
- 网络
- 笔记

---
# 一、 子网掩码的概念及作用  
  
子网掩码 (subnet mask) 又叫网络掩码、地址掩码、子网络遮罩，是一个应用于 TCP/IP 网络的 32 位二进制值。它可以屏蔽掉 IP 地址中的一部分，从而分离出 IP 地址中的网络部分与主机部分，基于子网掩码，管理员可以将网络进一步划分为若干子网。它必须结合 IP 地址一起使用。

# 二、 为什么需要使用子网掩码  
  
虽然我们说子网掩码可以分离出 IP 地址中的网络部分与主机部分，可大家还是会有疑问，比如为什么要区分网络地址与主机地址？区分以后又怎样呢？那么好，让我们再详细的讲一下吧！  

在使用 TCP/IP 协议的两台计算机之间进行通信时，我们通过将本机的子网掩码与接受方主机的 IP 地址进行 ' 与 ' 运算，即可得到目标主机所在的网络号，又由于每台主机在配置 TCP/IP 协议时都设置了一个本机 IP 地址与子网掩码，所以可以知道本机所在的网络号。

通过比较这两个网络号，就可以知道接受方主机是否在本网络上。如果网络号相同，表明接受方在本网络上，那么可以通过相关的协议把数据包直接发送到目标主机；如果网络号不同，表明目标主机在远程网络上，那么数据包将会发送给本网络上的路由器，由路由器将数据包发送到其他网络，直至到达目的地。在这个过程中你可以看到，子网掩码是不可或缺的！

# 三、 如何用子网掩码得到网络 / 主机地址  
  
既然子网掩码这么重要，那么它是如何分离出 IP 地址中的网络地址和主机地址的呢？

过程如下：

1. 将 IP 地址与子网掩码转换成二进制；

2. 将二进制形式的 IP 地址与子网掩码做 ' 与 ' 运算，将答案化为十进制便得到网络地址；

3. 将二进制形式的子网掩码取 ' 反 ' ；

4. 将取 ' 反 ' 后的子网掩码与 IP 地址做 ' 与 ' 运算，将答案化为十进制便得到主机地址。

下面我们用一个例子给大家演示：

假设有一个 I P 地址： 192.168.0.1

子网掩码为： 255.255.255.0

化为二进制为： I P 地址 11000000.10101000.00000000.00000001

子网掩码 11111111.11111111.11111111.00000000

将两者做 ' 与 ' 运算得： 11000000.10101000.00000000.00000000

将其化为十进制得： 192.168.0.0

这便是上面 IP 的网络地址，主机地址以此类推。
<!-- more -->

小技巧：由于观察到上面的子网掩码为 C 类地址的默认子网掩码（至于为什么，可看后面的子网掩码分类就明白了），便可直接看出网络地址为 IP 地址的前三部分，即前三个字节，主机地址为最后一部分。

** 解惑：**

什么？你还是不懂？问我为什么要做 ' 与 ' 运算而不是别的？其实你仔细观察一下上面的例子就应该能明白。

'1' 在做 ' 与 ' 运算时，保存对应项结果， '0' 在做 ' 与 ' 运算时，将对应项清零，利用 ' 与 ' 的这个特性，当管理员设置子网掩码时，即将子网掩码上与网络地址所对应的位都设为 '1', 其他位都设为 '0', 那么当作 ' 与 ' 时， IP 地址中的网络号将被保留到结果中，而主机号将被置 0 ，这样就解析出了网络号，解析主机号也一样，只需先把子网掩码取 ' 反 ', 再做 ' 与 ' 。

# 四、 子网掩码的分类  

## 1 ）缺省子网掩码：

即未划分子网，对应的网络号的位都置 1 ，主机号都置 0 。

A 类网络缺省子网掩码： 255.0.0.0

B 类网络缺省子网掩码： 255.255.0.0

C 类网络缺省子网掩码： 255.255.255.0

## 2 ）自定义子网掩码：

将一个网络划分为几个子网，需要每一段使用不同的网络号或子网号，实际上我们可以认为是将主机号分为两个部分：子网号、子网主机号。 形式如下：

未做子网划分的 IP 地址：网络号＋主机号

做子网划分后的 IP 地址：网络号＋子网号＋子网主机号

也就是说 IP 地址在划分子网后，以前的主机号位置的一部分给了子网号，余下的是子网主机号。

# 五、子网编址技术
  
前面几点介绍了子网掩码的一些知识，下面我们来看看子网划分，不要认为子网划分与子网掩码没有关系哟，子网划分也是靠子网掩码来实现的。

子网划分说白了是这样一个事情：因为在划分了子网后， IP 地址的网络号是不变的，因此在局域网外部看来，这里仍然只存在一个网络，即网络号所代表的那个网络；但在网络内部却是另外一个景象，因为我们每个子网的子网号是不同的，当用化分子网后的 IP 地址与子网掩码（注意，这里指的子网掩码已经不是缺省子网掩码了，而是自定义子网掩码，是管理员在经过计算后得出的）做 ' 与 ' 运算时，每个子网将得到不同的子网地址，从而实现了对网络的划分（得到了不同的地址，当然就能区别出各个子网了，有趣吧）。

子网编址技术 ，即子网划分将会有助于以下问题的解决：

1 ）巨大的网络地址管理耗费：如果你是一个 A 类网络的管理员，你一定会为管理数量庞大的主机而头痛的；

2 ）路由器中的选路表的急剧膨胀：当路由器与其他路由器交换选路表时，互联网的负载是很高的，所需的计算量也很高；

3 ） IP 地址空间有限并终将枯竭：这是一个至关重要的问题，高速发展的 internet, 使原来的编址方法不能适应，而一些 IP 地址却不能被充分的利用，造成了浪费。

因此，在配置局域网或其他网络时，根据需要划分子网是很重要的，有时也是必要的。现在，子网编址技术已经被绝大多数局域网所使用。

# 六、 如何划分子网及确定子网掩码 
  
在动手划分之前，一定要考虑网络目前的需求和将来的需求计划。

划分子网主要从以下方面考虑 :

1. 网络中物理段的数量（即要划分的子网数量）

2. 每个物理段的主机的数量

** 确定子网掩码的步骤： **

- 第一步：确定物理网段的数量，并将其转换为二进制数，并确定位数 n 。如：你需要 6 个子网， 6 的二进制值为 110 ，共 3 位 , 即 n=3 ；

- 第二步：按照你 IP 地址的类型写出其缺省子网掩码。如 C 类，则缺省子网掩码为 11111111.11111111.11111111.00000000 ；

- 第三步：将子网掩码中与主机号的前 n 位对应的位置置 1 ，其余位置置 0 。若 n=3 且为

- C 类地址：则得到子网掩码为 11111111.11111111.11111111.11100000 化为十进制得到 255.255.255.224

- B 类地址：则得到子网掩码为 11111111.11111111.11100000.00000000 化为十进制得到 255.255.224.0

- A 类地址：则得到子网掩码为 11111111.11100000.00000000.00000000 化为十进制得到 255.224.0.0

另：由于网络被划分为 6 个子网，占用了主机号的前 3 位，若是 C 类地址，则主机号只能用 5 位来表示主机号，因此每个子网内的主机数量＝（ 2^5 ）－ 2 ＝ 30 ， 6 个子网总共所能标识的主机数将小于 254 ，这点请大家注意！（至于为什么减 2 ，可看后面说明）

** 解惑：**

你可能有这样的疑问，比如在上面的例子里， 6 的二进制值为 110 ，那么为什么要将子网掩码中与主机号的前 n 位对应的位置都置 1 ，而不是用 6 的二进制 110 去替代前 n 位呢？

呵呵，这个问题提的很好，答案是这样的：我们计算子网掩码的目的是什么？就是希望它在做 ' 与 ' 的时候能够解析出网络号，也就是说它与网络号所对应的位置都应该是 1 （当然包括与子网号所对应的位置），那么很显然，你写上 110 是不对的，如果你这么写，那么它的意义是主机号的前两位作为子网号，那么这样将最多划分 2 个子网（不明白没关系，下面有计算子网数量的方法），与我们当初所要划分的 6 个子网显然是不一致的。这样解释你能明白马？

细心的人可能会发现，划分 4 个子网， 5 个子网和 6 个子网的子网掩码是一样的，同为 255.255.255.224 ，是不是错了呢？三个子网掩码应该不同呀？呵呵，是这样的，因为 4 ， 5 ， 6 的二进制值都是 3 为，因此在子网掩码中这三位都置 1 ，划分是没有问题的，只是你的理解上有一点小小的问题，划分为 4 个子网，其实可以理解为划分为 6 个子网，但你只使用了其中的 4 个。比如你想划分 8 个子网，与划分 14 个子网所得到的子网掩码是一样的，都占用了 4 位作为子网号。

# 七、相关问题  
  
## 1.如何判断是否做了子网划分？

如果它使用了缺省子网掩码，那么表示没有作子网划分；反之，则一定作了子网划分。

## 2.如何计算子网地址？

将 IP 地址与子网掩码的二进制形式做 ' 与 ' ，得到的结果即为子网地址。

## 3.如何计算主机地址？

先将子网掩码的二进制取 ' 反 ' ，再与 IP 地址做 ' 与 ' 。

## 4.如何计算子网数量？

这个问题大家会常常提到，还是从子网掩码入手，主要有两个步骤：

- 观察子网掩码的二进制形式，确定作为子网号的位数 n ；

- 子网数量为 2^n － 2 。（为什么减 2 ，继续往下看）

举个例子来说，比如有这样一个子网掩码： 255.255.255.224 其二进制为：

11111111.11111111.11111111.11100000

可见 n=3,2 的 3 次方为 8 ，说明子网地址可能有

如下 8 种情况：

000      001      010       011      100     101      110      111

但其中代表网络自身的 000 ；代表广播地址的 111 是被保留的，所以要减 2 。

## 5.如何计算总主机数量，子网内主机数量？

总主机数量＝子网数量×子网内主机数量

再用一个例子给大家说明，比如子网掩码为 255.255.255.224

上面的讨论知道它最多可以划分 6 个子网，那么每个子网内最多有多少个主机呢？其实上面我已经给大家算过了，由于网络被划分为 6 个子网，占用了主机号的前 3 位，且是 C 类地址，则主机号只能用 5 位来表示主机号，因此子网内的主机数量＝（ 2 的 5 次方）－ 2 ＝ 30.

因此通过这个子网掩码我们可以算出这个网络最多可以标识 6*30=180 个主机（可见，在化分子网后，整个网络所能标识的主机数量将减少）。

## 6.计算自定义子网 IP 地址范围

通过一个自定义子网掩码，我们可以得到这个网络所有可能的 IP 地址范围。

具体步骤：

- 写出二进制子网地址；

- 将子网地址化为十进制；

- 计算子网所能容纳主机数；

- 得出 IP 范围（起始地址：子网地址＋ 1 ；终止地址：子网地址＋主机数）

假设一个子网掩码为： 255.255.255.224 ，可知其最多可以划分 6 个子网，子网内主机数为 30 ，那么所有可能的 IP 地址及计算流程如下：

子网－－——子网地址（二进制）－－－－－－子网地址－－－－－实际 IP 范围

1 － 11001010.01110000.00001010.00100000 － 202.112.10.32 － 202.112.10.33~202.112.10.62

2 － 11001010.01110000.00001010.01000000 － 202.112.10.64 － 202.112.10.65~202.112.10.94

3 － 11001010.01110000.00001010.01100000 － 202.112.10.96 － 202.112.10.97~202.112.10.126

4 － 11001010.01110000.00001010.10000000 － 202.112.10.128 － 202.112.10.129~202.112.10.158

5 － 11001010.01110000.00001010.10100000 － 202.112.10.160 － 202.112.10.161~202.112.10.190

6 － 11001010.01110000.00001010.11000000 － 202.112.10.192 － 202.112.10.193~202.112.10.222

来源：http://blog.csdn.net/jason314/article/details/5447743